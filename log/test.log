/home/ykn/anaconda3/envs/cds/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/ykn/anaconda3/envs/cds/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN3c104impl8GPUTrace13gpuTraceStateE
  warn(f"Failed to load image Python extension: {e}")
Dataset ImageFolder
    Number of datapoints: 5712
    Root location: /home/ykn/cds/chapter03_Python_image_classification/data/Brain Tumor MRI Dataset/archive/Training
    StandardTransform
Transform: Compose(
               Resize(size=256, interpolation=bilinear, max_size=None, antialias=None)
               CenterCrop(size=(224, 224))
               ToTensor()
           )
571
571
571
571
571
571
571
571
571
571



patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([27, 196, 384])
pos_embed torch.Size([27, 197, 384])
patch_drop torch.Size([27, 197, 384])
norm_pre torch.Size([27, 3, 224, 224])
norm torch.Size([27, 197, 384])
Epoch 0 done.
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([27, 196, 384])
pos_embed torch.Size([27, 197, 384])
patch_drop torch.Size([27, 197, 384])
norm_pre torch.Size([27, 3, 224, 224])
norm torch.Size([27, 197, 384])
Epoch 1 done.
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([27, 196, 384])
pos_embed torch.Size([27, 197, 384])
patch_drop torch.Size([27, 197, 384])
norm_pre torch.Size([27, 3, 224, 224])
norm torch.Size([27, 197, 384])
Epoch 2 done.
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([27, 196, 384])
pos_embed torch.Size([27, 197, 384])
patch_drop torch.Size([27, 197, 384])
norm_pre torch.Size([27, 3, 224, 224])
norm torch.Size([27, 197, 384])
Epoch 0 done.
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([27, 196, 384])
pos_embed torch.Size([27, 197, 384])
patch_drop torch.Size([27, 197, 384])
norm_pre torch.Size([27, 3, 224, 224])
norm torch.Size([27, 197, 384])
Epoch 1 done.
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
patch_embed torch.Size([32, 196, 384])
pos_embed torch.Size([32, 197, 384])
patch_drop torch.Size([32, 197, 384])
norm_pre torch.Size([32, 3, 224, 224])
norm torch.Size([32, 197, 384])
Traceback (most recent call last):
  File "main.py", line 98, in <module>
    diff = c.local_train(server.global_model)
  File "/home/ykn/cds/chapter03_Python_image_classification/client.py", line 52, in local_train
    loss.backward()
  File "/home/ykn/anaconda3/envs/cds/lib/python3.7/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/ykn/anaconda3/envs/cds/lib/python3.7/site-packages/torch/autograd/__init__.py", line 175, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
